cm4all-beng-proxy (0.7.20) unstable; urgency=low

  * http-client: don't reinstate event when socket is closed
  * access-log: log the site name
  * python: removed unused function write_packet()
  * python: split the module beng_proxy.translation
  * python: allow overriding query string and param in absolute_uri()
  * python: moved absolute_uri() to a separate library

 -- Max Kellermann <mk@cm4all.com>  Thu, 11 Mar 2010 09:48:52 +0100

cm4all-beng-proxy (0.7.19) unstable; urgency=low

  * client-socket: translate EV_TIMEOUT to ETIMEDOUT
  * fork: refill the input buffer as soon as possible
  * delegate-client: implement an abortable event
  * pool: added assertions for libevent leaks
  * direct: added option "-s enable_splice=no"

 -- Max Kellermann <mk@cm4all.com>  Thu, 04 Mar 2010 17:34:56 +0100

cm4all-beng-proxy (0.7.18) unstable; urgency=low

  * args: reserve memory for the trailing null byte

 -- Max Kellermann <mk@cm4all.com>  Tue, 23 Feb 2010 17:46:04 +0100

cm4all-beng-proxy (0.7.17) unstable; urgency=low

  * translation: added the BOUNCE packet (variant of REDIRECT)
  * translation: change widget packet HOST to UNTRUSTED
  * translation: pass internal URI arguments to the translation server
  * handler: use the specified status with REDIRECT
  * python: added method Request.absolute_uri()

 -- Max Kellermann <mk@cm4all.com>  Tue, 23 Feb 2010 16:15:22 +0100

cm4all-beng-proxy (0.7.16) unstable; urgency=low

  * processor: separate trusted from untrusted widgets by host name
  * processor: mode=partition is deprecated
  * translate: fix DOCUMENT_ROOT handler for CGI/FASTCGI
  * fcgi-request: added JailCGI support

 -- Max Kellermann <mk@cm4all.com>  Fri, 19 Feb 2010 14:29:29 +0100

cm4all-beng-proxy (0.7.15) unstable; urgency=low

  * processor: unreference the caller pool in abort()
  * tcache: clear BASE on mismatch
  * fcgi-client: generate the Content-Length request header
  * fcgi-client: send the CONTENT_TYPE parameter
  * prototypes/translate.py: use FastCGI to run PHP

 -- Max Kellermann <mk@cm4all.com>  Thu, 11 Feb 2010 14:43:21 +0100

cm4all-beng-proxy (0.7.14) unstable; urgency=low

  * connection: drop connections when the limit is exceeded
  * resource-address: added BASE support
  * fcgi-client: check the request ID in response packets
  * http-client: check response body when request body is closed
  * html-escape: use the last ampersand before the semicolon
  * html-escape: support &apos;
  * processor: unescape widget parameter values

 -- Max Kellermann <mk@cm4all.com>  Fri, 29 Jan 2010 17:49:43 +0100

cm4all-beng-proxy (0.7.13) unstable; urgency=low

  * fcgi-request: duplicate socket path
  * fcgi-request: support ACTION
  * fcgi-client: provide SCRIPT_FILENAME
  * fcgi-client: append empty PARAMS packet
  * fcgi-client: try to read response before request is finished
  * fcgi-client: implement the STDERR packet
  * fcgi-client: support request headers and body
  * fcgi-stock: manage one socket per child process
  * fcgi-stock: unlink socket path after connect
  * fcgi-stock: redirect fd 1,2 to /dev/null
  * fcgi-stock: kill FastCGI processes after 5 minutes idle
  * translation: new packet PAIR for passing parameters to FastCGI

 -- Max Kellermann <mk@cm4all.com>  Thu, 14 Jan 2010 13:36:48 +0100

cm4all-beng-proxy (0.7.12) unstable; urgency=low

  * http-cache: unlock the cache item after successful revalidation
  * http-cache-memcached: pass the expiration time to memcached
  * sink-header: comprise pending data in method available()
  * header-forward: forward the Expires response header

 -- Max Kellermann <mk@cm4all.com>  Tue, 22 Dec 2009 16:18:49 +0100

cm4all-beng-proxy (0.7.11) unstable; urgency=low

  * {ajp,memcached}-client: fix dis\appearing event for duplex socket
  * memcached-client: handle EAGAIN after send()
  * memcached-client: release socket as early as possible
  * header-forward: don't forward Accept-Encoding if transformation is
    enabled
  * widget-http, inline-widget: check Content-Encoding before processing
  * file-handler: send "Vary: Accept-Encoding" for compressed response
  * header-forward: support duplicate headers
  * fcache: implemented a 60 seconds timeout
  * fcache: copy pointer to local variable before callback
  * event2: refresh timeout after event has occurred

 -- Max Kellermann <mk@cm4all.com>  Fri, 18 Dec 2009 16:45:24 +0100

cm4all-beng-proxy (0.7.10) unstable; urgency=low

  * http-{server,client}: fix disappearing event for duplex socket

 -- Max Kellermann <mk@cm4all.com>  Mon, 14 Dec 2009 15:46:25 +0100

cm4all-beng-proxy (0.7.9) unstable; urgency=low

  * http: "Expect" is a hop-by-hop header
  * http-server: send "100 Continue" unless request body closed
  * http-client: poll socket after splice
  * http-server: handle EAGAIN after splice
  * http-server: send a 417 response on unrecognized "Expect" request
  * response, widget-http: append filter id to resource tag
  * resource-tag: check for "Cache-Control: no-store"

 -- Max Kellermann <mk@cm4all.com>  Mon, 14 Dec 2009 13:05:15 +0100

cm4all-beng-proxy (0.7.8) unstable; urgency=low

  * http-body: support partial response in method available()
  * file-handler: support pre-compressed static files
  * fcache: honor the "Cache-Control: no-store" response header

 -- Max Kellermann <mk@cm4all.com>  Wed, 09 Dec 2009 15:49:25 +0100

cm4all-beng-proxy (0.7.7) unstable; urgency=low

  * parser: allow underscore in attribute names
  * processor: check "type" attribute before URI rewriting
  * http-client: start receiving before request is sent
  * http-client: try to read response after write error
  * http-client: deliver response body after headers are finished
  * http-client: release socket as early as possible
  * http-client: serve buffer after socket has been closed
  * istream-chunked: clear input stream in abort handler
  * growing-buffer: fix crash after close in "data" callback

 -- Max Kellermann <mk@cm4all.com>  Thu, 03 Dec 2009 13:09:57 +0100

cm4all-beng-proxy (0.7.6) unstable; urgency=low

  * istream-hold: return -2 if handler is not available yet
  * http, ajp, fcgi: use istream_hold on request body
  * http-client: implemented splicing the request body
  * response: added missing URI substitution

 -- Max Kellermann <mk@cm4all.com>  Tue, 17 Nov 2009 15:25:35 +0100

cm4all-beng-proxy (0.7.5) unstable; urgency=low

  * session: 64 bit session ids
  * session: allow arbitrary session id size (at compile-time)
  * debian: larger default log file (16 * 4MB)
  * debian: added package cm4all-beng-proxy-toi

 -- Max Kellermann <mk@cm4all.com>  Mon, 16 Nov 2009 15:51:24 +0100

cm4all-beng-proxy (0.7.4) unstable; urgency=low

  * measure the latency of external resources
  * widget-http: partially revert "don't query session if !stateful"

 -- Max Kellermann <mk@cm4all.com>  Tue, 10 Nov 2009 15:06:03 +0100

cm4all-beng-proxy (0.7.3) unstable; urgency=low

  * uri-verify: don't reject double slash after first segment
  * hostname: allow the hyphen character
  * processor: allow processing without session
  * widget-http: don't query session if !stateful
  * request: disable session management for known bots
  * python: fixed AttributeError in __getattr__()
  * python: added method Response.process()
  * translation: added the response packets URI, HOST, SCHEME
  * translation: added header forward packets

 -- Max Kellermann <mk@cm4all.com>  Mon, 09 Nov 2009 16:40:27 +0100

cm4all-beng-proxy (0.7.2) unstable; urgency=low

  * fcache: close all caching connections on exit
  * istream-file: retry reading after EAGAIN
  * direct, istream-pipe: re-enable SPLICE_F_NONBLOCK
  * direct, istream-pipe: disable the SPLICE_F_MORE flag
  * http-client: handle EAGAIN after splice
  * http-client, header-writer: remove hop-by-hop response headers
  * response: optimized transformed response headers
  * handler: mangle CGI and FastCGI headers
  * header-forward: generate the X-Forwarded-For header
  * header-forward: add local host name to "Via" request header

 -- Max Kellermann <mk@cm4all.com>  Fri, 30 Oct 2009 13:41:02 +0100

cm4all-beng-proxy (0.7.1) unstable; urgency=low

  * file-handler: close the stream on "304 Not Modified"
  * pool: use assembler code only on gcc
  * cmdline: added option "--set tcp_stock_limit"
  * Makefile.am: enable the "subdir-objects" option

 -- Max Kellermann <mk@cm4all.com>  Thu, 22 Oct 2009 12:17:11 +0200

cm4all-beng-proxy (0.7) unstable; urgency=low

  * ajp-client: check if connection was closed during response callback
  * header-forward: log session id
  * istream: separate TCP splicing checks
  * istream-pipe: fix segmentation fault after incomplete direct transfer
  * istream-pipe: implement the "available" method
  * istream-pipe: allocate pipe only if handler supports it
  * istream-pipe: flush the pipe before reading from input
  * istream-pipe: reuse pipes in a stock
  * direct: support splice() from TCP socket to pipe
  * istream: direct() returns -3 if stream has been closed
  * hstock: don't destroy stocks while items are being created
  * tcp-stock: limit number of connections per host to 256
  * translate, http-client, ajp-client, cgi, http-cache: verify the HTTP
    response status
  * prototypes/translate.py: disallow "/../" and null bytes
  * prototypes/translate.py: added "/jail-delegate/" location
  * uri-parser: strict RFC 2396 URI verification
  * uri-parser: don't unescape the URI path
  * http-client, ajp-client: verify the request URI
  * uri-escape: unescape each character only once
  * http-cache: never use the memcached stock if caching is disabled
  * allow 8192 connections by default
  * allow 65536 file handles by default
  * added package cm4all-jailed-beng-proxy-delegate-helper

 -- Max Kellermann <mk@cm4all.com>  Wed, 21 Oct 2009 15:00:56 +0200

cm4all-beng-proxy (0.6.23) unstable; urgency=low

  * header-forward: log session information
  * prototypes/translate.py: added /cgi-bin/ location
  * http-server: disable keep-alive for HTTP/1.0 clients
  * http-server: don't send "Connection: Keep-Alive"
  * delegate-stock: clear the environment
  * delegate-stock: added jail support
  * delegate-client: reuse helper process after I/O error

 -- Max Kellermann <mk@cm4all.com>  Mon, 12 Oct 2009 17:29:35 +0200

cm4all-beng-proxy (0.6.22) unstable; urgency=low

  * istream-tee: clear both "enabled" flags in the eof/abort handler
  * istream-tee: fall back to first data() return value if second stream
    closed itself
  * http-cache: don't log body_abort after close

 -- Max Kellermann <mk@cm4all.com>  Thu, 01 Oct 2009 19:19:37 +0200

cm4all-beng-proxy (0.6.21) unstable; urgency=low

  * http-client: log more error messages
  * delegate-stock: added the DOCUMENT_ROOT environment variable
  * response, widget: accept "application/xhtml+xml"
  * cookie-server: allow square brackets in unquoted cookie values
    (violating RFC 2109 and RFC 2616)

 -- Max Kellermann <mk@cm4all.com>  Thu, 01 Oct 2009 13:55:40 +0200

cm4all-beng-proxy (0.6.20) unstable; urgency=low

  * stock: clear stock after 60 seconds idle
  * hstock: remove empty stocks
  * http-server, http-client, cgi: fixed off-by-one bug in header parser
  * istream-pipe: fix the direct() return value on error
  * istream-pipe: fix formula in range assertion
  * http-cache-memcached: implemented "remove"
  * handler: added FastCGI handler
  * fcgi-client: unref caller pool after socket release
  * fcgi-client: implemented response headers

 -- Max Kellermann <mk@cm4all.com>  Tue, 29 Sep 2009 14:07:13 +0200

cm4all-beng-proxy (0.6.19) unstable; urgency=low

  * http-client: release caller pool after socket release
  * memcached-client: release socket on marshalling error
  * stock: unref caller pool in abort handler
  * stock: lazy cleanup
  * http-cache: copy caller_pool to local variable

 -- Max Kellermann <mk@cm4all.com>  Thu, 24 Sep 2009 16:02:17 +0200

cm4all-beng-proxy (0.6.18) unstable; urgency=low

  * delegate-handler: support conditional GET and ranges
  * file-handler: fix suffix-byte-range-spec parser
  * delegate-helper: call open() with O_CLOEXEC|O_NOCTTY
  * istream-file: don't set FD_CLOEXEC if O_CLOEXEC is available
  * stock: hold caller pool during "get" operation
  * main: free balancer object during shutdown
  * memcached-client: enable socket timeout
  * delegate-stock: set FD_CLOEXEC on socket

 -- Max Kellermann <mk@cm4all.com>  Thu, 24 Sep 2009 10:50:53 +0200

cm4all-beng-proxy (0.6.17) unstable; urgency=low

  * tcp-stock: implemented a load balancer
  * python: accept address list in the ajp() method
  * http-server: added timeout for the HTTP request headers
  * response: close template when the content type is wrong
  * delegate-get: implemented response headers
  * delegate-get: provide status codes and error messages

 -- Max Kellermann <mk@cm4all.com>  Fri, 18 Sep 2009 15:36:57 +0200

cm4all-beng-proxy (0.6.16) unstable; urgency=low

  * tcp-stock: added support for bulldog-tyke
  * sink-buffer: close input if it's not used in the constructor
  * http-cache-memcached: close response body when deserialization fails
  * serialize: fix regression in serialize_uint64()

 -- Max Kellermann <mk@cm4all.com>  Tue, 15 Sep 2009 19:26:07 +0200

cm4all-beng-proxy (0.6.15) unstable; urgency=low

  * http-cache-choice: find more duplicates during cleanup
  * handler: added AJP handler
  * ajp-request: unref pool only on tcp_stock failure
  * ajp-client: prevent parser recursion
  * ajp-client: free request body when response is closed
  * ajp-client: reuse connection after END_RESPONSE packet
  * ajp-client: enable TCP_CORK while sending
  * istream-ajp-body: added a second "length" header field
  * ajp-client: auto-send empty request body chunk
  * ajp-client: register "write" event after GET_BODY_CHUNK packet
  * ajp-client: implemented request and response headers
  * http-cache-rfc: don't rewind tpool if called recursively

 -- Max Kellermann <mk@cm4all.com>  Fri, 11 Sep 2009 16:04:06 +0200

cm4all-beng-proxy (0.6.14) unstable; urgency=low

  * istream-tee: don't restart reading if already in progress

 -- Max Kellermann <mk@cm4all.com>  Thu, 03 Sep 2009 13:21:06 +0200

cm4all-beng-proxy (0.6.13) unstable; urgency=low

  * cookie-server: fix parsing multiple cookies
  * http-cache-memcached: clean up expired "choice" items
  * sink-gstring: use callback instead of public struct
  * istream-tee: restart reading when one output is closed

 -- Max Kellermann <mk@cm4all.com>  Wed, 02 Sep 2009 17:02:53 +0200

cm4all-beng-proxy (0.6.12) unstable; urgency=low

  * http-cache: don't attempt to remove cache items when the cache is disabled

 -- Max Kellermann <mk@cm4all.com>  Fri, 28 Aug 2009 15:40:48 +0200

cm4all-beng-proxy (0.6.11) unstable; urgency=low

  * http-cache-memcached: store HTTP status and response headers
  * http-cache-memcached: implemented flush (SIGHUP)
  * http-cache-memcached: support "Vary"
  * http-client: work around assertion failure in response_stream_close()

 -- Max Kellermann <mk@cm4all.com>  Thu, 27 Aug 2009 12:33:17 +0200

cm4all-beng-proxy (0.6.10) unstable; urgency=low

  * parser: finish tag before bailing out
  * http-request: allow URLs without path component
  * fork: clear event in read() method
  * istream-file: pass options O_CLOEXEC|O_NOCTTY to open()
  * response: check if the "Host" request header is valid

 -- Max Kellermann <mk@cm4all.com>  Tue, 18 Aug 2009 16:37:19 +0200

cm4all-beng-proxy (0.6.9) unstable; urgency=low

  * direct: disable SPLICE_F_NONBLOCK (temporary NFS EAGAIN workaround)

 -- Max Kellermann <mk@cm4all.com>  Mon, 17 Aug 2009 13:52:49 +0200

cm4all-beng-proxy (0.6.8) unstable; urgency=low

  * widget-http: close response body in error code path
  * http-cache: implemented memcached backend (--memcached-server)
  * processor: &c:base; returns the URI without scheme and host

 -- Max Kellermann <mk@cm4all.com>  Mon, 17 Aug 2009 12:29:19 +0200

cm4all-beng-proxy (0.6.7) unstable; urgency=low

  * file-handler: generate Expires from xattr user.MaxAge
  * cmdline: added option --set to configure:
    - max_connections
    - http_cache_size
    - filter_cache_size
    - translate_cache_size
  * flush caches on SIGHUP

 -- Max Kellermann <mk@cm4all.com>  Fri, 07 Aug 2009 11:41:10 +0200

cm4all-beng-proxy (0.6.6) unstable; urgency=low

  * added missing GLib build dependency
  * cgi-handler: set the "body_consumed" flag

 -- Max Kellermann <mk@cm4all.com>  Tue, 04 Aug 2009 09:53:01 +0200

cm4all-beng-proxy (0.6.5) unstable; urgency=low

  * shm: pass MAP_NORESERVE to mmap()
  * proxy-handler: support cookies
  * translation: added DISCARD_SESSION packet

 -- Max Kellermann <mk@cm4all.com>  Wed, 15 Jul 2009 18:00:33 +0200

cm4all-beng-proxy (0.6.4) unstable; urgency=low

  * http-client: don't read response body in HEAD requests
  * ajp-client: invoke the "abort" handler on error
  * filter-cache: lock cache items while they are served

 -- Max Kellermann <mk@cm4all.com>  Thu, 09 Jul 2009 14:36:14 +0200

cm4all-beng-proxy (0.6.3) unstable; urgency=low

  * http-server: implemented the DELETE method
  * http-server: refuse HTTP/0.9 requests
  * proxy-handler: send request body to template when no widget is focused
  * widget-request: pass original HTTP method to widget
  * session: automatically defragment sessions

 -- Max Kellermann <mk@cm4all.com>  Tue, 07 Jul 2009 16:57:22 +0200

cm4all-beng-proxy (0.6.2) unstable; urgency=low

  * lock: fixed race condition in debug flag updates
  * session: use rwlock for the session manager
  * proxy-handler: pass request headers to the remote HTTP server
  * proxy-handler: forward original Accept-Charset if processor is disabled
  * pipe: don't filter resources without a body
  * fcache: forward original HTTP status over "pipe" filter
  * cgi: support the "Status" line

 -- Max Kellermann <mk@cm4all.com>  Mon, 06 Jul 2009 16:38:26 +0200

cm4all-beng-proxy (0.6.1) unstable; urgency=low

  * session: consistently lock all session objects
  * rewrite-uri: check if widget_external_uri() returns NULL
  * widget-uri: don't generate the "path" argument when it's NULL
  * widget-uri: strip superfluous question mark from widget_base_address()
  * widget-uri: append parameters from the template first
  * widget-uri: re-add configured query string in widget_absolute_uri()
  * widget-uri: eliminate configured query string in widget_external_uri()
  * processor: don't consider session data for base=child and base=parent

 -- Max Kellermann <mk@cm4all.com>  Fri, 03 Jul 2009 15:52:01 +0200

cm4all-beng-proxy (0.6) unstable; urgency=low

  * inline-widget: check the widget HTTP response status
  * response: don't apply transformation on failed response
  * resource-address: include pipe arguments in filter cache key
  * handler: removed session redirect on the first request
  * http-cache: accept ETag response header instead of Last-Modified
  * filter-cache: don't require Last-Modified or Expires
  * file-handler: disable ETag only when processor comes first
  * file-handler: read ETag from xattr
  * pipe: generate new ETag for piped resource
  * session: purge sessions when shared memory is full
  * handler: don't enforce sessions for filtered responses

 -- Max Kellermann <mk@cm4all.com>  Tue, 30 Jun 2009 17:48:20 +0200

cm4all-beng-proxy (0.5.14) unstable; urgency=low

  * ajp-client: implemented request body
  * cookie-client: obey "max-age=0" properly
  * processor: forward the original HTTP status
  * response, widget-http: don't allow processing resource without body
  * widget-http: check the Content-Type before invoking processor
  * response: pass the "Location" response header
  * debian: added a separate -optimized-dbg package
  * added init script support for multiple ports (--port) and multiple listen
    (--listen) command line argumnents
  * translation: added the "APPEND" packet for command line arguments
  * pipe: support command line arguments

 -- Max Kellermann <mk@cm4all.com>  Mon, 29 Jun 2009 16:51:16 +0200

cm4all-beng-proxy (0.5.13) unstable; urgency=low

  * widget-registry: clear local_address in translate request
  * cmdline: added the "--listen" option

 -- Max Kellermann <mk@cm4all.com>  Wed, 24 Jun 2009 12:27:17 +0200

cm4all-beng-proxy (0.5.12) unstable; urgency=low

  * response: pass the "Location" response handler
  * added support for multiple listener ports

 -- Max Kellermann <mk@cm4all.com>  Tue, 23 Jun 2009 23:34:55 +0200

cm4all-beng-proxy (0.5.11) unstable; urgency=low

  * build with autotools
  * use libcm4all-socket, GLib
  * Makefile.am: support out-of-tree builds
  * added optimized Debian package
  * tcache: fixed wrong assignment in VARY=HOST
  * translation: added request packet LOCAL_ADDRESS

 -- Max Kellermann <mk@cm4all.com>  Tue, 23 Jun 2009 15:42:12 +0200

cm4all-beng-proxy (0.5.10) unstable; urgency=low

  * widget-http: assign the "address" variable

 -- Max Kellermann <mk@cm4all.com>  Mon, 15 Jun 2009 18:38:58 +0200

cm4all-beng-proxy (0.5.9) unstable; urgency=low

  * tcache: fixed typo in tcache_string_match()
  * tcache: support VARY=SESSION
  * translate: added the INVALIDATE response packet
  * cache, session: higher size limits
  * widget-uri: separate query_string from path_info
  * widget-uri: ignore widget parameters in widget_external_uri()

 -- Max Kellermann <mk@cm4all.com>  Mon, 15 Jun 2009 17:06:11 +0200

cm4all-beng-proxy (0.5.8) unstable; urgency=low

  * handler: fixed double free bug in translate_callback()

 -- Max Kellermann <mk@cm4all.com>  Sun, 14 Jun 2009 19:05:09 +0200

cm4all-beng-proxy (0.5.7) unstable; urgency=low

  * forward the Content-Disposition header
  * handler: assign new session to local variable, fix segfault
  * handler: don't dereference the NULL session

 -- Max Kellermann <mk@cm4all.com>  Sun, 14 Jun 2009 13:01:52 +0200

cm4all-beng-proxy (0.5.6) unstable; urgency=low

  * widget-http: send the "Via" request header instead of "X-Forwarded-For"
  * proxy-handler: send the "Via" request header
  * widget-request: check the "path" argument before calling uri_compress()

 -- Max Kellermann <mk@cm4all.com>  Tue, 09 Jun 2009 12:21:00 +0200

cm4all-beng-proxy (0.5.5) unstable; urgency=low

  * processor: allow specifying relative URI in c:base=child
  * widget-request: verify the "path" argument
  * widget: allocate address from widget's pool
  * widget-http: support multiple Set-Cookie response headers

 -- Max Kellermann <mk@cm4all.com>  Thu, 04 Jun 2009 15:10:15 +0200

cm4all-beng-proxy (0.5.4) unstable; urgency=low

  * implemented delegation of open() to a helper program
  * added the BASE translation packet, supported by the translation cache
  * deprecated c:mode=proxy
  * rewrite-uri: always enable focus in mode=partial
  * http-cache: don't cache resources with query string (RFC 2616 13.9)
  * http-cache: lock cache items while they are served

 -- Max Kellermann <mk@cm4all.com>  Thu, 28 May 2009 11:44:01 +0200

cm4all-beng-proxy (0.5.3) unstable; urgency=low

  * cgi: close request body on fork() failure
  * fork: added workaround for pipe-to-pipe splice()
  * http-cache: use cache entry when response ETag matches
  * cgi: loop in istream_cgi_read() to prevent blocking
  * cache: check for expired items once a minute
  * cache: optimize search for oldest item

 -- Max Kellermann <mk@cm4all.com>  Wed, 06 May 2009 13:23:46 +0200

cm4all-beng-proxy (0.5.2) unstable; urgency=low

  * added filter cache
  * header-parser: added missing range check in header_parse_line()
  * fork: added event for writing to the child process
  * fork: don't splice() from a pipe
  * response: don't pass request body to unfocused processor
  * added filter type "pipe"

 -- Max Kellermann <mk@cm4all.com>  Wed, 29 Apr 2009 13:24:26 +0200

cm4all-beng-proxy (0.5.1) unstable; urgency=low

  * processor: fixed base=child assertion failure
  * handler: close request body if it was not consumed
  * static-file: generate Last-Modified and ETag response headers
  * static-file: obey the Content-Type provided by the translation server
  * static-file: get Content-Type from extended attribute
  * http-cache: use istream_null when cached resource is empty

 -- Max Kellermann <mk@cm4all.com>  Mon, 27 Apr 2009 10:00:20 +0200

cm4all-beng-proxy (0.5) unstable; urgency=low

  * processor: accept c:mode/c:base attributes in any order
  * processor: removed alternative (anchor) rewrite syntax

 -- Max Kellermann <mk@cm4all.com>  Mon, 20 Apr 2009 22:04:19 +0200

cm4all-beng-proxy (0.4.10) unstable; urgency=low

  * processor: lift length limitation for widget parameters
  * translate: abort if a packet is too large
  * translate: support MAX_AGE for the whole response
  * hashmap: fix corruption of slot chain in hashmap_remove_value()

 -- Max Kellermann <mk@cm4all.com>  Fri, 17 Apr 2009 13:02:50 +0200

cm4all-beng-proxy (0.4.9) unstable; urgency=low

  * http-cache: explicitly start reading into cache
  * cgi: clear "headers" variable before publishing the response
  * translate: use DOCUMENT_ROOT as CGI parameter

 -- Max Kellermann <mk@cm4all.com>  Mon, 06 Apr 2009 16:21:57 +0200

cm4all-beng-proxy (0.4.8) unstable; urgency=low

  * translate: allow ADDRESS packets in AJP addresses
  * translate: initialize all fields of a FastCGI address
  * http-cache: close all caching connections on exit
  * processor: don't rewrite SCRIPT SRC attribute when proxying

 -- Max Kellermann <mk@cm4all.com>  Thu, 02 Apr 2009 15:45:46 +0200

cm4all-beng-proxy (0.4.7) unstable; urgency=low

  * http-server: use istream_null for empty request body
  * parser: check for trailing slash only in TAG_OPEN tags
  * parser: added support for XML Processing Instructions
  * processor: implemented XML Processing Instruction "cm4all-rewrite-uri"
  * uri-escape: escape the slash character
  * cache: remove all matching items in cache_remove()
  * http-cache: lock cache items while holding a reference

 -- Max Kellermann <mk@cm4all.com>  Thu, 02 Apr 2009 12:02:53 +0200

cm4all-beng-proxy (0.4.6) unstable; urgency=low

  * file_handler: fixed logic error in If-Modified-Since check
  * date: return UTC time stamp in http_date_parse()
  * cache: continue search after item was invalidated
  * cache: remove the correct cache item
  * istream-chunked: work around invalid assertion failure
  * istream-subst: fixed corruption after partial match

 -- Max Kellermann <mk@cm4all.com>  Wed, 25 Mar 2009 15:03:10 +0100

cm4all-beng-proxy (0.4.5) unstable; urgency=low

  * http-server: assume keep-alive is enabled on HTTP 1.1
  * http-client: unregister EV_READ when the buffer is full
  * translation: added QUERY_STRING packet
  * processor: optionally parse base/mode from URI

 -- Max Kellermann <mk@cm4all.com>  Tue, 17 Mar 2009 13:04:25 +0100

cm4all-beng-proxy (0.4.4) unstable; urgency=low

  * forward Accept-Language request header to the translation server
  * translate: added the USER_AGENT request packet
  * session: obey the USER/MAX_AGE setting
  * use libcm4all-inline-dev in libcm4all-beng-proxy-dev
  * added pkg-config file for libcm4all-beng-proxy-dev
  * updated python-central dependencies
  * processor: parse c:base/c:mode attributes in PARAM tags

 -- Max Kellermann <mk@cm4all.com>  Wed, 11 Mar 2009 09:43:48 +0100

cm4all-beng-proxy (0.4.3) unstable; urgency=low

  * processor: rewrite URI in LINK tags
  * processor: rewrite URI in PARAM tags
  * use splice() from glibc 2.7
  * translate: added VARY response packet
  * build documentation with texlive

 -- Max Kellermann <mk@cm4all.com>  Wed, 04 Mar 2009 09:53:56 +0100

cm4all-beng-proxy (0.4.2) unstable; urgency=low

  * hashmap: fix corruption in slot chain
  * use monotonic clock to calculate expiry times
  * processor: rewrite URIs in the EMBED, VIDEO, AUDIO tags

 -- Max Kellermann <mk@cm4all.com>  Tue, 17 Feb 2009 17:14:48 +0100

cm4all-beng-proxy (0.4.1) unstable; urgency=low

  * translate: clear client->transformation
  * handler: check for translation errors
  * http-server: fixed assertion failure during shutdown
  * http-server: send "Keep-Alive" response header
  * worker: after fork(), call event_reinit() in the parent process
  * added valgrind build dependency
  * build with Debian's libevent-1.4 package

 -- Max Kellermann <mk@cm4all.com>  Tue, 10 Feb 2009 11:48:53 +0100

cm4all-beng-proxy (0.4) unstable; urgency=low

  * added support for transformation views
    - in the JavaScript API, mode=proxy is now deprecated
  * http-cache: fix segfault when request_headers==NULL
  * http-cache: store multiple (varying) versions of a resource
  * http-cache: use the "max-age" cache-control response

 -- Max Kellermann <mk@cm4all.com>  Fri, 30 Jan 2009 13:29:43 +0100

cm4all-beng-proxy (0.3.9) unstable; urgency=low

  * http-client: assume keep-alive is enabled on HTTP 1.1
  * processor: use configured/session path-info for mode=child URIs

 -- Max Kellermann <mk@cm4all.com>  Tue, 27 Jan 2009 13:07:51 +0100

cm4all-beng-proxy (0.3.8) unstable; urgency=low

  * processor: pass Content-Type and Content-Language headers from
    template
  * http-client: allow chunked response body without keep-alive

 -- Max Kellermann <mk@cm4all.com>  Fri, 23 Jan 2009 13:02:42 +0100

cm4all-beng-proxy (0.3.7) unstable; urgency=low

  * istream_subst: exit the loop if state==INSERT
  * istream_iconv: check if the full buffer could be flushed
  * worker: don't reinitialize session manager during shutdown

 -- Max Kellermann <mk@cm4all.com>  Thu, 15 Jan 2009 10:39:47 +0100

cm4all-beng-proxy (0.3.6) unstable; urgency=low

  * processor: ignore closing </header>
  * widget-http: now really don't check content-type in frame parents
  * parser: skip comments
  * processor: implemented c:base="parent"
  * processor: added "c:" prefix to c:widget child elements
  * processor: renamed the "c:param" element to "c:parameter"

 -- Max Kellermann <mk@cm4all.com>  Thu, 08 Jan 2009 11:17:29 +0100

cm4all-beng-proxy (0.3.5) unstable; urgency=low

  * widget-http: don't check content-type in frame parents
  * istream-subst: allow null bytes in the input stream
  * js: added the "translate" parameter for passing values to the
    translation server
  * rewrite-uri: refuse to rewrite a frame URI without widget id

 -- Max Kellermann <mk@cm4all.com>  Mon, 05 Jan 2009 16:46:32 +0100

cm4all-beng-proxy (0.3.4) unstable; urgency=low

  * processor: added support for custom widget request headers
  * http-cache: obey the "Vary" response header
  * http-cache: pass the new http_cache_info object when testing a cache
    item

 -- Max Kellermann <mk@cm4all.com>  Tue, 30 Dec 2008 15:46:44 +0100

cm4all-beng-proxy (0.3.3) unstable; urgency=low

  * processor: grew widget parameter buffer to 512 bytes
  * widget-resolver: clear widget->resolver on abort
  * cgi: clear the input's handler in cgi_async_abort()
  * widget-stream: use istream_hold (reverts r4171)

 -- Max Kellermann <mk@cm4all.com>  Fri, 05 Dec 2008 14:43:05 +0100

cm4all-beng-proxy (0.3.2) unstable; urgency=low

  * processor: free memory before calling embed_frame_widget()
  * processor: allocate query string from the widget pool
  * processor: removed the obsolete widget attributes "tag" and "style"
  * parser: hold a reference to the pool

 -- Max Kellermann <mk@cm4all.com>  Mon, 01 Dec 2008 14:15:38 +0100

cm4all-beng-proxy (0.3.1) unstable; urgency=low

  * http-client: remove Transfer-Encoding and Content-Length from response
    headers
  * http-client: don't read body after invoke_response()
  * fork: retry splice() after EAGAIN
  * fork: don't close input when splice() fails
  * cgi: abort the response handler when the stdin stream fails
  * istream_file, istream_pipe, fork, client_socket, listener: fixed file
    descriptor leaks
  * processor: hold a reference to the caller's pool
  * debian/rules: enabled test suite

 -- Max Kellermann <mk@cm4all.com>  Thu, 27 Nov 2008 16:01:16 +0100

cm4all-beng-proxy (0.3) unstable; urgency=low

  * implemented widget filters
  * translate: initialize all fields of a CGI address
  * fork: read request body on EAGAIN
  * fork: implemented the direct() method with splice()
  * python: added class Response
  * prototypes/translate.py:
    - support "filter"
    - support "content_type"
  * demo: added widget filter demo

 -- Max Kellermann <mk@cm4all.com>  Wed, 26 Nov 2008 16:27:29 +0100

cm4all-beng-proxy (0.2) unstable; urgency=low

  * don't quote text/xml widgets
  * widget-resolver: pass widget_pool to widget_class_lookup()
  * widget-registry: allocate widget_class from widget_pool
  * widget-stream: eliminated the async operation proxy, because the
    operation cannot be aborted before the constructor returns
  * widget-stream: don't clear the "delayed" stream in the response() callback
  * rewrite-uri: trigger istream_read(delayed) after istream_delayed_set()
  * doc: clarified XSLT integration

 -- Max Kellermann <mk@cm4all.com>  Tue, 25 Nov 2008 15:28:54 +0100

cm4all-beng-proxy (0.1) unstable; urgency=low

  * initial release

 -- Max Kellermann <mk@cm4all.com>  Mon, 17 Nov 2008 11:59:36 +0100
